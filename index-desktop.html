<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Wedding Invitation (Desktop) - Zen & Yessica</title>
  <style>
    body, html { 
      margin:0; 
      padding:0; 
      height:100%; 
      font-family:Arial, sans-serif; 
      background:#333; 
      color:white; 
    }
    .container { 
      display:flex; 
      height:100vh; 
    }
    .left { 
      flex:0 0 65%; 
      background:url("images/Main-Image.jpeg") no-repeat center center; 
      background-size:cover; 
    }
    .right { 
      flex:0 0 35%; 
      background:rgba(0,0,0,0.6); 
      padding:40px 20px; 
      text-align:center; 
      overflow-y:auto; 
    }
    .gallery { 
      display:grid; 
      grid-template-columns: repeat(auto-fit, minmax(120px, 1fr)); 
      gap:15px; 
      margin-bottom:20px; 
    }
    .gallery img { 
      width:100%; 
      height:150px; 
      border-radius:10px; 
      object-fit:cover; 
    }
    form input, form select, form textarea {
      border:none;
      border-radius:8px;
      margin-bottom:10px;
      font-size:1rem;
      width:90%;
      padding:10px;
    }
    form button {
      padding:10px 20px; 
      background:#bc8887; 
      color:white; 
      border:none; 
      border-radius:8px; 
      cursor:pointer;
      font-size:1rem;
    }
    #wishesList { 
      text-align:left; 
      margin-top:20px; 
      padding:10px; 
      background:rgba(255,255,255,0.1); 
      border-radius:8px; 
      max-height:300px; 
      overflow-y:auto; 
    }
    .wish { 
      margin-bottom:10px; 
      padding:10px; 
      border-bottom:1px solid #666; 
    }
    #music-control {
      position:fixed; 
      bottom:20px; 
      right:20px; 
      background:#bc8887;
      color:white;
      border:none;
      border-radius:50%;
      width:50px;
      height:50px;
      font-size:1.2rem;
      cursor:pointer;
    }
  </style>
</head>
<body>
  <!-- Music -->
  <audio id="bg-music" loop>
    <source src="music/Dive-Olivia Dean-Acoustic.mp3" type="audio/mpeg">
  </audio>
  <button id="music-control">üîä</button>

  <div class="container">
    <div class="left"></div>
    <div class="right">
      <h3>Dear Mr/Mrs [Guest Name]</h3>
      <h1>Zen & Yessica</h1>
      <p>Wedding Thanksgiving Greeting</p>
      <p>Saturday, 17 January 2025</p>
      <hr>
      <p style="margin:20px 0; font-style:italic;">
        ‚ÄúSo they are no longer two, but one flesh.<br>
        What therefore God has joined together, let no man separate.‚Äù<br>
        Matthew 19:6
      </p>

      <h2>The Groom</h2><p>Zen</p>
      <h2>The Bride</h2><p>Yessica</p>

      <h2>Holy Matrimony</h2>
      <p>Gereja Santo Fransiskus Asisi</p>
      <iframe src="https://www.google.com/maps?q=Gereja+Katolik+St+Fransiskus+Asisi+Cibinong&output=embed" 
              width="100%" height="250" style="border:0; border-radius:8px;"></iframe>

      <h2>Reception</h2>
      <p>Bagas Raya Cibinong</p>
      <iframe src="https://www.google.com/maps?q=Bagas+Raya+Cibinong&output=embed" 
              width="100%" height="250" style="border:0; border-radius:8px;"></iframe>

      <h2>Our Moment</h2>
      <div class="gallery">
        <img src="images/photo1.jpg" alt="Moment 1">
        <img src="images/photo2.jpg" alt="Moment 2">
        <img src="images/photo3.jpg" alt="Moment 3">
      </div>

      <h2>RSVP & Wishes</h2>
      <form id="rsvpForm">
        <input name="Name" type="text" placeholder="Your Name" required><br>
        <select name="Attendance" required>
          <option value="">-- Apakah Anda akan hadir? --</option>
          <option value="Ya">Ya, saya akan hadir</option>
          <option value="Tidak">Maaf, saya tidak bisa hadir</option>
        </select><br>
        <textarea name="Wishes" placeholder="Your wishes..."></textarea><br>
        <button type="submit">Send</button>
      </form>
      <p id="responseMsg"></p>

      <h2 style="margin-top:40px;">All Wishes üíå</h2>
      <div id="wishesList"><p>Loading wishes...</p></div>
    </div>
  </div>

  <script>
    const scriptURL = "https://script.google.com/macros/s/AKfycbyRkHV4cNIeYWuTpobbXS6fQ8IOxLMRkryE6pW17hsDUKtghPA7RVtPHP9JuYvb2Lsg/exec"; // üîó Ganti dengan Google Script kamu

    // Music
    const music=document.getElementById("bg-music"), controlBtn=document.getElementById("music-control");
    controlBtn.onclick=()=>{ 
      if(music.paused){
        music.play(); 
        controlBtn.textContent="üîä";
      } else {
        music.pause(); 
        controlBtn.textContent="üîá";
      } 
    }

    // Time Ago
    function timeAgo(dateString) {
      const now=new Date(); 
      const date=new Date(dateString); 
      const diff=(now-date)/1000;
      if(diff<60) return "baru saja";
      const minutes=Math.floor(diff/60); if(minutes<60) return `${minutes} menit lalu`;
      const hours=Math.floor(minutes/60); if(hours<24) return `${hours} jam lalu`;
      const days=Math.floor(hours/24); if(days<7) return `${days} hari lalu`;
      const weeks=Math.floor(days/7); return `${weeks} minggu lalu`;
    }

    // Form submit
    const form=document.getElementById("rsvpForm"), msg=document.getElementById("responseMsg");
    form.addEventListener("submit",e=>{
      e.preventDefault();
      fetch(scriptURL,{method:"POST",body:new FormData(form)})
        .then(()=>{
          msg.textContent="‚úÖ RSVP berhasil dikirim!"; 
          msg.style.color="lightgreen"; 
          form.reset(); 
          loadWishes();
        })
        .catch(()=>{
          msg.textContent="‚ùå Gagal mengirim RSVP."; 
          msg.style.color="red";
        });
    });

    // Load wishes
    async function loadWishes(){
      try{
        const res=await fetch(scriptURL); 
        const data=await res.json();
        document.getElementById("wishesList").innerHTML=data.reverse().map(w=>`
          <div class="wish">
            <strong>${w.name}</strong><br>
            <em>"${w.wishes}"</em><br>
            <small>${timeAgo(w.timestamp)}</small>
          </div>
        `).join("");
      }catch{
        document.getElementById("wishesList").innerHTML="<p>‚ùå Gagal load ucapan.</p>";
      }
    }
    loadWishes();
  </script>
</body>
</html>
