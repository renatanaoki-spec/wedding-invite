<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Wedding Invitation - Zen & Yessica</title>

  <!-- Google Fonts for secondary text -->
  <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;600&display=swap" rel="stylesheet">

  <style>
    /* ====== Load local White Angelica ====== */
    @font-face{
      font-family:"White Angelica";
      src:url("font/WhiteAngelica.ttf") format("truetype");
      font-weight:400; font-style:normal; font-display:swap;
    }

    :root{
      --mauve:#b46b88;
      --mauve-dark:#9a5673;
      --ivory:#fffefd;
    }

    /* Base */
    *{box-sizing:border-box}
    html,body{
      margin:0; padding:0;
      font-family:'Poppins',sans-serif;
      color:#2f2f2f;
      background:url("image/BG3.jpeg") center/cover fixed no-repeat; /* ‚¨Ö BG3 */
      overflow-x:hidden;
    }

    /* Headings */
    h1,h2{ color:var(--mauve); margin:0 0 .6rem 0 }

    /* Cover (own page, not overlay) */
    .cover{
      position:relative; width:100%; min-height:100vh;
      display:flex; flex-direction:column; justify-content:center; align-items:center;
      text-align:center;
      background:url("image/BG3.jpeg") center/cover no-repeat; /* ‚¨Ö match body */
      padding:40px 16px;
    }
    /* Bride & Groom name looks like a logo/image */
    .couple-name{
      font-family:"White Angelica", cursive;
      font-weight:400;
      font-size:clamp(42px, 10vw, 96px);
      color:#ffffff;
      letter-spacing:0;
      line-height:1.05;
      -webkit-text-stroke:1px rgba(0,0,0,.12);
      text-shadow:
        0 2px 8px rgba(0,0,0,.25),
        0 0 24px rgba(255,255,255,.35);
      margin-bottom:8px;
    }
    .cover p{
      color:#fff; font-size:1.1rem; text-shadow:0 1px 4px rgba(0,0,0,.35);
      margin:4px 0 22px;
    }
    .btn{
      display:inline-block; padding:12px 28px; border:none; border-radius:999px;
      background:var(--mauve); color:#fff; font-weight:600; cursor:pointer; text-decoration:none;
      box-shadow:0 10px 24px rgba(180,107,136,.25); transition:.25s;
    }
    .btn:hover{ background:var(--mauve-dark); transform:translateY(-1px) }

    section{ padding:56px 18px; text-align:center }

    /* Hero (transparent, so BG3 shows through) */
    .hero{
      min-height:100vh; display:flex; flex-direction:column; justify-content:center; align-items:center;
      color:#fff; text-shadow:0 2px 10px rgba(0,0,0,.35);
      background:transparent;
    }
    .hero h1{ font-size:clamp(42px,8vw,88px); color:#fff }
    .quote{ max-width:720px; margin:18px auto 32px; font-size:1.1rem }

    #countdown{ display:flex; gap:18px; justify-content:center; flex-wrap:wrap; font-weight:700 }
    .time-box{ min-width:90px }
    .time-box span{ display:block; font-size:2rem; color:#fff }

    /* Music button */
    #music-control{
      position:fixed; bottom:20px; right:20px; z-index:10;
      background:var(--mauve); color:#fff; border:none; border-radius:50%;
      width:52px; height:52px; font-size:1.2rem; cursor:pointer; display:none;
      box-shadow:0 8px 20px rgba(180,107,136,.35);
    }

    /* Form + notes */
    form{ max-width:560px; margin:0 auto; display:flex; flex-direction:column; gap:14px; text-align:left }
    form input, form textarea, form select{
      padding:12px; border:1px solid #ddd; border-radius:10px; font-size:1rem; background:rgba(255,255,255,.92)
    }
    form textarea{ min-height:110px; resize:vertical }
    form button{ background:var(--mauve); color:#fff; border:none; border-radius:10px; padding:12px; font-weight:600; cursor:pointer }
    form button:hover{ background:var(--mauve-dark) }
    #responseMsg{ text-align:center; margin-top:10px; font-weight:600 }

    #notesContainer{ margin-top:28px; max-width:620px; margin-inline:auto; text-align:left }
    .note{ padding:12px; border-bottom:1px solid rgba(0,0,0,.1) }
    .note strong{ color:var(--mauve) }
    .pagination{ margin-top:14px; display:flex; justify-content:center; gap:10px }
    .pagination button{ padding:8px 14px; border:none; border-radius:8px; background:var(--mauve); color:#fff; cursor:pointer }
    .pagination button:disabled{ background:#cfcfcf; cursor:not-allowed }
  </style>
</head>
<body>

  <!-- üé∂ Music -->
  <audio id="bg-music" loop>
    <source src="music/Music-1.mp3" type="audio/mpeg">
  </audio>
  <button id="music-control">‚è∏Ô∏è</button>

  <!-- ===== Cover page (separate) ===== -->
  <section class="cover" id="coverPage">
    <div class="couple-name">Zen &amp; Yessica</div>
    <p>Dear <span id="guestName">Guest</span></p>
    <button id="openBtn" class="btn">Open Invitation</button>
  </section>

  <!-- ===== Hero ===== -->
  <section class="hero">
    <h1>SAVE THE DATE</h1>
    <p class="quote">
      ‚ÄúMarriage is an act of worship, and every act of worship leads to His love as its ultimate goal. 
      It is only fitting that every effort to attain His love is pursued with joy.‚Äù
    </p>

    <div id="countdown">
      <div class="time-box"><span id="days">00</span>Days</div>
      <div class="time-box"><span id="hours">00</span>Hours</div>
      <div class="time-box"><span id="minutes">00</span>Minutes</div>
      <div class="time-box"><span id="seconds">00</span>Seconds</div>
    </div>

    <a class="btn" 
       href="https://calendar.google.com/calendar/render?action=TEMPLATE&text=Zen+%26+Yessica+Wedding&dates=20260117T030000Z/20260117T090000Z&details=Join+us+for+our+wedding+day!&location=Gereja+Santo+Fransiskus+Asisi,+Cibinong" 
       target="_blank">SAVE THE DATE</a>
  </section>

  <!-- ===== Details ===== -->
  <section>
    <h2>Wedding Day</h2>
    <p class="date">Saturday, 17 January 2026</p>
    <p class="venue">Holy Matrimony: Gereja Santo Fransiskus Asisi, Cibinong</p>
    <p class="venue">Reception: Bagas Raya Cibinong</p>
  </section>

  <!-- ===== Verse ===== -->
  <section>
    <h2>Bible Verse</h2>
    <p class="verse">
      ‚ÄúSo they are no longer two, but one flesh.  
      What therefore God has joined together, let no man separate.‚Äù  
      <br>‚Äì Matthew 19:6
    </p>
  </section>

  <!-- ===== RSVP & Notes ===== -->
  <section>
    <h2>RSVP & Notes</h2>
    <form id="rsvpForm">
      <input type="hidden" name="token" value="ZENYESSICA2026">
      <input type="hidden" id="referer" name="referer">

      <input name="Name" id="nameInput" type="text" placeholder="We‚Äôd like to know you üíå" required>
      <small id="nameError" class="error-msg" style="display:none;color:#d46a6a">Oops, please tell us your name üå∑</small>

      <textarea name="Notes" placeholder="Write your wishes and prayers for us"></textarea>

      <div class="attendance-wrapper" style="text-align:center">
        <p class="attendance-label">Attendance confirmation</p>
        <select name="Attendance" id="attendanceInput" required style="width:80%;text-align:center">
          <option value="">-- Select attendance --</option>
          <option value="Yes">üíñ Yes, I‚Äôll be there</option>
          <option value="No">üå∏ Sorry, can‚Äôt attend</option>
        </select>
        <small id="attendanceError" class="error-msg" style="display:none;color:#d46a6a">Please let us know if you can attend üíê</small>
      </div>

      <button type="submit">SEND</button>
    </form>
    <p id="responseMsg"></p>

    <h2>Guest Notes üíå</h2>
    <div id="notesContainer">Loading...</div>
    <div class="pagination">
      <button id="prevBtn">Prev</button>
      <button id="nextBtn">Next</button>
    </div>
  </section>

  <footer>
    <p>With love, <span style="font-family:'White Angelica',cursive">Zen &amp; Yessica</span> üíï</p>
  </footer>

  <!-- ===== Script ===== -->
  <script>
    const scriptURL = "https://script.google.com/macros/s/AKfycbwRSHvhi28_Fes26DuLR8Ywf0zqY2U7ePzQCdb_4vyUH_Nq0_culqdSfb1U7tajj8zT/exec";
    document.getElementById("referer").value = window.location.hostname;

    const openBtn = document.getElementById("openBtn");
    const music = document.getElementById("bg-music");
    const controlBtn = document.getElementById("music-control");

    // Guest name from URL
    const guest = new URLSearchParams(location.search).get("to");
    if (guest) document.getElementById("guestName").textContent = guest;

    // Open invitation -> scroll to hero (cover remains)
    openBtn.addEventListener("click", ()=>{
      controlBtn.style.display = "block";
      music.play().catch(()=>{});
      document.querySelector(".hero").scrollIntoView({behavior:"smooth"});
    });

    // Music button toggle + pause on tab hide
    controlBtn.addEventListener("click", ()=>{
      if (music.paused){ music.play(); controlBtn.textContent = "‚è∏Ô∏è"; }
      else { music.pause(); controlBtn.textContent = "‚ñ∂Ô∏è"; }
    });
    document.addEventListener("visibilitychange", ()=>{ if(document.hidden){ music.pause(); controlBtn.textContent="‚ñ∂Ô∏è"; } });
    window.addEventListener("beforeunload", ()=>music.pause());

    // Countdown
    const dEl = document.getElementById("days"),
          hEl = document.getElementById("hours"),
          mEl = document.getElementById("minutes"),
          sEl = document.getElementById("seconds");
    function updateCountdown(){
      const target = new Date("Jan 17, 2026 09:00:00").getTime();
      const now = Date.now(); const diff = target - now;
      if (diff <= 0){ document.getElementById("countdown").innerHTML = "üéâ Today is the wedding day!"; return; }
      dEl.textContent = Math.floor(diff / (1000*60*60*24));
      hEl.textContent = Math.floor((diff % (1000*60*60*24)) / (1000*60*60));
      mEl.textContent = Math.floor((diff % (1000*60*60)) / (1000*60));
      sEl.textContent = Math.floor((diff % (1000*60)) / 1000);
    }
    setInterval(updateCountdown,1000); updateCountdown();

    // RSVP submit
    const form = document.getElementById("rsvpForm");
    const nameError = document.getElementById("nameError");
    const attendanceError = document.getElementById("attendanceError");
    const msg = document.getElementById("responseMsg");

    form.addEventListener("submit", e=>{
      e.preventDefault();
      const name = form.Name.value.trim();
      const att = form.Attendance.value;
      let valid = true;
      if(!name){ nameError.style.display="block"; valid=false; } else nameError.style.display="none";
      if(!att){ attendanceError.style.display="block"; valid=false; } else attendanceError.style.display="none";
      if(!valid){ msg.textContent="‚ö†Ô∏è Please check the form again, some fields are missing üå∏"; msg.style.color="#d46a6a"; return; }

      msg.textContent="‚è≥ Sending..."; msg.style.color="gray";
      fetch(scriptURL,{ method:"POST", body:new FormData(form) })
        .then(r=>r.json())
        .then(data=>{
          if(data.status==="success"){ msg.textContent="‚úÖ RSVP berhasil dikirim! Thank you üíï"; msg.style.color="green"; form.reset(); loadNotes(); }
          else { msg.textContent="‚ùå Gagal mengirim RSVP."; msg.style.color="red"; }
        })
        .catch(err=>{ msg.textContent="‚ùå Error: "+err; msg.style.color="red"; });
    });

    // Time-ago helper (Bahasa)
    function timeAgo(ts){
      const now=new Date(), d=new Date(ts); const s=(now-d)/1000;
      if(s<60) return "baru saja";
      const m=Math.floor(s/60); if(m<60) return `${m} menit lalu`;
      const h=Math.floor(m/60); if(h<24) return `${h} jam lalu`;
      const day=Math.floor(h/24); if(day<7) return `${day} hari lalu`;
      const w=Math.floor(day/7); if(w<4) return `${w} minggu lalu`;
      const mo=Math.floor(day/30); return `${mo} bulan lalu`;
    }

    // Notes + pagination
    let notes=[], currentPage=1; const perPage=5;
    async function loadNotes(){
      try{
        const res=await fetch(scriptURL); notes=await res.json();
        notes.sort((a,b)=> new Date(b.timestamp)-new Date(a.timestamp));
        renderNotes();
      }catch{ document.getElementById("notesContainer").innerHTML="<p>‚ùå Gagal load notes.</p>"; }
    }
    function renderNotes(){
      const c=document.getElementById("notesContainer"); c.innerHTML="";
      if(!notes.length){ c.innerHTML="<p>No notes yet.</p>"; return; }
      const start=(currentPage-1)*perPage, end=start+perPage;
      notes.slice(start,end).forEach(n=>{
        const icon = n.attendance==="Yes" ? "üíñ" : (n.attendance==="No" ? "üå∏" : "");
        c.innerHTML += `<div class="note"><strong>${n.name}</strong> ${icon}<br><em>${n.notes}</em><br><small>${timeAgo(n.timestamp)}</small></div>`;
      });
      prevBtn.disabled = currentPage===1;
      nextBtn.disabled = end >= notes.length;
    }
    const prevBtn=document.getElementById("prevBtn"), nextBtn=document.getElementById("nextBtn");
    prevBtn.addEventListener("click",()=>{ if(currentPage>1){ currentPage--; renderNotes(); }});
    nextBtn.addEventListener("click",()=>{ if(currentPage*perPage<notes.length){ currentPage++; renderNotes(); }});
    loadNotes();
  </script>
</body>
</html>
