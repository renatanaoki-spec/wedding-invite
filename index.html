<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0"/>
<title>Wedding Invitation - Zen & Yessica</title>

<!-- Redirect to cover if not opened -->
<script>
(function(){
  const qpOpened = new URLSearchParams(location.search).get('opened') === '1';
  let ssOpened = false; try{ ssOpened = sessionStorage.getItem('opened') === '1'; }catch(e){}
  if(!qpOpened && !ssOpened){ location.replace('cover.html' + (location.search || '')); }
})();
</script>

<!-- Font Awesome for elegant icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css"/>

<style>
  /* ===== Local fonts ===== */
  @font-face{
    font-family:"White Angelica";
    src:url("font/WhiteAngelica.ttf") format("truetype");
    font-display:swap;
  }
  /* Optional: add MrsEaves.ttf to /font and uncomment
  @font-face{
    font-family:"Mrs Eaves";
    src:url("font/MrsEaves.ttf") format("truetype");
    font-display:swap;
  } */

  :root{
    --sage:#6f8b6a; --sage-strong:#5e7a5b;
    --rose:#b36b85; --rose-2:#9a5673;
    --forest:#26352b; --ivory:#fffdf5;
  }

  *{box-sizing:border-box}
  html,body{height:100%;margin:0}
  body{
    font-family:"Mrs Eaves","Playfair Display",Georgia,serif;
    color:var(--forest);
    background:url("image/BG3.jpeg") center/cover fixed no-repeat;
    overflow:hidden; /* scrolling happens in #snap */
  }

  /* ===== Buttons / names ===== */
  .btn{
    display:inline-block; padding:12px 28px; border:none; border-radius:999px;
    background:var(--rose); color:#fff; font-weight:700; cursor:pointer; text-decoration:none;
    box-shadow:0 10px 24px rgba(179,107,133,.35); transition:.25s;
  }
  .btn:hover{ background:var(--rose-2); transform:translateY(-2px) }
  .names{
    font-family:"White Angelica", cursive;
    color:#fff; margin:8px 0 12px;
    -webkit-text-stroke:.5px rgba(0,0,0,.15);
    text-shadow:0 2px 10px rgba(0,0,0,.35), 0 0 22px rgba(255,255,255,.3);
  }

  /* ===== Scroll-snap sections ===== */
  #snap{ height:100vh; overflow-y:auto; scroll-snap-type:y mandatory; scroll-behavior:smooth; }
  section.s{ min-height:100vh; scroll-snap-align:start; scroll-snap-stop:always; display:flex; align-items:center; justify-content:center; padding:64px 18px; position:relative; }

  /* ===== HERO overlay for readability ===== */
  .hero::before{
    content:""; position:absolute; inset:0; z-index:0;
    background:
      radial-gradient(100% 70% at 50% 40%, rgba(18,24,21,.62) 0%, rgba(18,24,21,.32) 60%, rgba(18,24,21,.12) 100%),
      linear-gradient(to bottom, rgba(18,24,21,.48), rgba(18,24,21,.2) 55%, rgba(18,24,21,0) 100%);
    backdrop-filter: blur(1.2px);
  }
  .hero > .inner{ position:relative; z-index:1 }

  /* ===== Glass cards ===== */
  .inner{
    width:min(960px,92vw); background:rgba(255,255,255,.92); border-radius:16px; padding:28px;
    box-shadow:0 10px 30px rgba(0,0,0,.14);
  }
  .inner.transparent{ background:transparent; box-shadow:none }
  h1.title{ color:#fff; font-size:clamp(38px,7vw,86px); margin:0 0 8px; text-shadow:0 4px 22px rgba(0,0,0,.55) }
  .quote{ color:#f5f5f2; text-shadow:0 3px 14px rgba(0,0,0,.5); max-width:760px; margin:12px auto 22px; }
  h2{ color:var(--sage-strong); margin:0 0 .4rem }

  /* ===== Countdown chips ===== */
  #countdown{ display:flex; gap:14px; justify-content:center; flex-wrap:wrap }
  .chip{
    min-width:100px; text-align:center; padding:10px 14px; border-radius:14px;
    background:rgba(255,255,255,.14); border:1px solid rgba(255,255,255,.35);
    color:#fff; backdrop-filter: blur(2px); box-shadow:0 6px 18px rgba(0,0,0,.18);
  }
  .chip span{ display:block; font-size:2rem }
  .chip span.pop{ animation:pop .5s cubic-bezier(.22,.61,.36,1) }
  @keyframes pop{ 0%{transform:scale(.9); opacity:.7} 60%{transform:scale(1.08); opacity:1} 100%{transform:scale(1)} }

  /* ===== Floating buttons (elegant glass) ===== */
  .round-fab,
  .ai-fab{
    position:fixed; z-index:60;
    width:56px; height:56px; border:none; border-radius:50%;
    display:grid; place-items:center; cursor:pointer;
    color:#fff;
    background: linear-gradient(180deg, rgba(179,107,133,.92), rgba(179,107,133,.78));
    border:1px solid rgba(255,255,255,.55);
    box-shadow: 0 12px 28px rgba(179,107,133,.35);
    backdrop-filter: blur(8px);
    transition: transform .18s ease, box-shadow .18s ease, background .18s ease;
  }
  .round-fab:hover, .ai-fab:hover{
    transform: translateY(-2px) scale(1.04);
    box-shadow: 0 16px 36px rgba(179,107,133,.45);
  }
  .round-fab:focus-visible, .ai-fab:focus-visible{
    outline: none;
    box-shadow: 0 0 0 3px rgba(255,255,255,.65), 0 12px 28px rgba(179,107,133,.35);
  }
  #music{ bottom: 20px; right: 18px; }
  #aiFab{ bottom: 90px; right: 18px; }  /* above music */
  #music i, #aiFab i{ font-size:20px; line-height:1; filter: drop-shadow(0 1px 1px rgba(0,0,0,.25)); }

  /* ===== Form & notes ===== */
  form{ max-width:560px; margin:0 auto; display:flex; flex-direction:column; gap:14px; text-align:left }
  form input, form textarea, form select{ padding:12px; border:1px solid #ddd; border-radius:10px; font-size:1rem; background:#fff }
  form textarea{ min-height:110px; resize:vertical }
  .pagination{ display:flex; gap:10px; justify-content:center; margin-top:12px }
  .pagination button{ padding:8px 14px; border:none; border-radius:8px; background:var(--rose); color:#fff; cursor:pointer }
  .pagination button:disabled{ background:#cfcfcf; cursor:not-allowed }
  .note{ padding:12px; border-bottom:1px solid rgba(0,0,0,.1); opacity:0; transform:translateY(8px) }
  .note.show{ opacity:1; transform:none; transition:opacity .5s, transform .5s }

  footer{ text-align:center; color:#4e6350; padding:26px 12px; font-weight:600; text-shadow:0 1px 1px rgba(255,255,255,.6) }

  /* ===== Aira Chat ===== */
  .ai-panel{
    position:fixed; right:18px; bottom:150px; z-index:60;
    width:min(92vw, 380px); max-height:70vh; display:flex; flex-direction:column;
    background:rgba(255,255,255,.96); border-radius:16px; box-shadow:0 18px 40px rgba(0,0,0,.22);
    opacity:0; transform:translateY(12px); pointer-events:none; transition:.25s;
  }
  .ai-panel.open{ opacity:1; transform:none; pointer-events:auto; }
  .ai-head{ display:flex; justify-content:space-between; align-items:center; padding:12px 14px; border-bottom:1px solid rgba(0,0,0,.08); color:var(--sage-strong) }
  .ai-close{ background:transparent; border:none; font-size:18px; cursor:pointer }
  .ai-body{ padding:12px; overflow:auto }
  .ai-msg{ display:flex; margin:10px 0 }
  .ai-msg.user{ justify-content:flex-end }
  .ai-bubble{
    max-width:78%; padding:10px 12px; border-radius:14px;
    background:#f3f6f2; border:1px solid rgba(0,0,0,.06); color:var(--forest);
  }
  .ai-msg.user .ai-bubble{ background:var(--rose); color:#fff; border-color:transparent }
  .ai-form{ display:flex; gap:8px; padding:12px; border-top:1px solid rgba(0,0,0,.08) }
  .ai-form input{ flex:1; padding:10px 12px; border:1px solid #ddd; border-radius:12px; font-size:1rem; background:#fff }
</style>
</head>
<body>

<!-- ===== Floating buttons ===== -->
<button id="aiFab" class="ai-fab" aria-label="Ask Aira">
  <i class="fa-regular fa-message"></i>
</button>

<button id="music" class="round-fab" title="Play/Pause" aria-label="Play music">
  <i class="fa-solid fa-play"></i>
</button>

<!-- ===== Music ===== -->
<audio id="bgm" loop>
  <source src="music/Music-1.mp3" type="audio/mpeg">
</audio>

<main id="snap">
  <!-- ===== HERO ===== -->
  <section class="s hero" id="home">
    <div class="inner transparent">
      <h1 class="title">SAVE THE DATE</h1>
      <h2 class="names">Zen &amp; Yessica</h2>
      <p id="dearLine" class="quote" style="display:none"></p>

      <p class="quote">
        ‚ÄúMarriage is an act of worship, and every act of worship leads to His love as its ultimate goal.
        It is only fitting that every effort to attain His love is pursued with joy.‚Äù
      </p>

      <div id="countdown" aria-label="Countdown to wedding">
        <div class="chip"><span id="d">00</span>Days</div>
        <div class="chip"><span id="h">00</span>Hours</div>
        <div class="chip"><span id="m">00</span>Minutes</div>
        <div class="chip"><span id="s">00</span>Seconds</div>
      </div>

      <p style="text-align:center; margin-top:16px">
        <a class="btn" target="_blank" rel="noopener"
           href="https://calendar.google.com/calendar/render?action=TEMPLATE&text=Zen+%26+Yessica+Wedding&dates=20260117T030000Z/20260117T090000Z&details=Join+us+for+our+wedding+day!&location=Gereja+Santo+Fransiskus+Asisi,+Cibinong">
          Add to Google Calendar
        </a>
      </p>
    </div>
  </section>

  <!-- ===== DETAILS ===== -->
  <section class="s" id="details">
    <div class="inner">
      <h2>Wedding Day</h2>
      <p>Saturday, 17 January 2026</p>
      <p>Holy Matrimony: Gereja Santo Fransiskus Asisi, Cibinong</p>
      <p>Reception: Bagas Raya Cibinong</p>
    </div>
  </section>

  <!-- ===== VERSE ===== -->
  <section class="s" id="verse">
    <div class="inner">
      <h2>Bible Verse</h2>
      <p>‚ÄúSo they are no longer two, but one flesh. What therefore God has joined together, let no man separate.‚Äù
        <br>‚Äì Matthew 19:6</p>
    </div>
  </section>

  <!-- ===== RSVP & NOTES ===== -->
  <section class="s" id="rsvp">
    <div class="inner">
      <h2>RSVP & Notes</h2>
      <form id="rsvpForm">
        <input type="hidden" name="token" value="ZENYESSICA2026">
        <input type="hidden" id="referer" name="referer">
        <input name="Name" type="text" placeholder="Your name üíå" required>
        <textarea name="Notes" placeholder="Write your wishes and prayers for us"></textarea>
        <select name="Attendance" required>
          <option value="">-- Attendance --</option>
          <option value="Yes">üíñ Yes, I‚Äôll be there</option>
          <option value="No">üå∏ Sorry, can‚Äôt attend</option>
        </select>
        <button type="submit" class="btn">Send</button>
      </form>
      <p id="responseMsg"></p>

      <h3 style="color:var(--sage-strong)">Guest Notes üíå</h3>
      <div id="notesContainer">Loading...</div>
      <div class="pagination">
        <button id="prevBtn" type="button">Prev</button>
        <button id="nextBtn" type="button">Next</button>
      </div>
    </div>
  </section>
</main>

<footer>With love, Zen &amp; Yessica üíï</footer>

<!-- ===== AIRA CHAT (UI) ===== -->
<div id="aiPanel" class="ai-panel" aria-live="polite" aria-hidden="true">
  <div class="ai-head">
    <strong>Aira</strong>
    <button type="button" class="ai-close" id="aiClose" title="Close">‚úï</button>
  </div>
  <div id="aiBody" class="ai-body"></div>
  <form id="aiForm" class="ai-form">
    <input id="aiText" type="text" placeholder="Tanya tentang acara‚Ä¶" autocomplete="off" />
    <button type="submit" class="btn">Send</button>
  </form>
</div>
<!-- ===== /AIRA CHAT ===== -->

<script>
  /* ===== Constants ===== */
  const WEDDING_DATE = new Date("2026-01-17T09:00:00+07:00"); // WIB
  const scriptURL = "https://script.google.com/macros/s/AKfycbwRSHvhi28_Fes26DuLR8Ywf0zqY2U7ePzQCdb_4vyUH_Nq0_culqdSfb1U7tajj8zT/exec";

  /* ===== Music controls ===== */
  const audio = document.getElementById('bgm');
  const musicBtn = document.getElementById('music');
  const musicIcon = musicBtn.querySelector('i');

  musicBtn.addEventListener('click', ()=>{
    if(audio.paused){
      audio.play();
      musicIcon.classList.remove('fa-play'); musicIcon.classList.add('fa-pause');
      musicBtn.setAttribute('aria-label','Pause music');
    }else{
      audio.pause();
      musicIcon.classList.remove('fa-pause'); musicIcon.classList.add('fa-play');
      musicBtn.setAttribute('aria-label','Play music');
    }
  });

  document.addEventListener('visibilitychange', ()=>{
    if(document.hidden){
      audio.pause();
      musicIcon.classList.remove('fa-pause'); musicIcon.classList.add('fa-play');
      musicBtn.setAttribute('aria-label','Play music');
    }
  });

  /* ===== Countdown with pop animation ===== */
  const dEl=document.getElementById('d'), hEl=document.getElementById('h'),
        mEl=document.getElementById('m'), sEl=document.getElementById('s');
  let prev={};
  const pop=(el,v,k)=>{ if(prev[k]!==v){ el.textContent=v; el.classList.remove('pop'); void el.offsetWidth; el.classList.add('pop'); prev[k]=v; } };
  function tick(){
    const t=WEDDING_DATE.getTime(), now=Date.now(), diff=t-now;
    const wrap=document.getElementById('countdown');
    if(diff<=0){ wrap.innerHTML="üéâ Today is the wedding day!"; return; }
    pop(dEl, Math.floor(diff/86400000), 'd');
    pop(hEl, Math.floor((diff%86400000)/3600000), 'h');
    pop(mEl, Math.floor((diff%3600000)/60000), 'm');
    pop(sEl, Math.floor((diff%60000)/1000), 's');
  }
  setInterval(tick,1000); tick();

  /* ===== Dear ?to= line ===== */
  (function(){
    const to = new URLSearchParams(location.search).get('to');
    if(to){
      const el = document.getElementById('dearLine');
      el.textContent = `Dear ${to}`; el.style.display='block';
    }
  })();

  /* ===== RSVP + Notes ===== */
  document.getElementById("referer").value = location.hostname;

  const form = document.getElementById('rsvpForm');
  const msg  = document.getElementById('responseMsg');

  form.addEventListener('submit', async (e)=>{
    e.preventDefault();
    if(!form.Name.value.trim() || !form.Attendance.value){
      msg.textContent="‚ö†Ô∏è Please fill out name and attendance üå∏"; msg.style.color="#c66"; return;
    }
    msg.textContent="‚è≥ Sending..."; msg.style.color="#666";
    try{
      const r=await fetch(scriptURL, { method:"POST", body:new FormData(form) });
      const data=await r.json();
      if(data.status==="success"){ msg.textContent="‚úÖ RSVP berhasil dikirim! Thank you üíï"; msg.style.color="green"; form.reset(); currentPage=1; loadNotes(); }
      else if(data.status==="duplicate"){ msg.textContent="‚ö†Ô∏è You already submitted recently."; msg.style.color="#bb8a4e"; }
      else if(data.status==="unauthorized" || data.status==="forbidden"){ msg.textContent="‚ùå Access denied. Please open from official link."; msg.style.color="crimson"; }
      else{ msg.textContent="‚ùå Gagal mengirim RSVP."; msg.style.color="crimson"; }
    }catch(err){ msg.textContent="‚ùå Error: "+err; msg.style.color="crimson"; }
  });

  function timeAgo(ts){
    const now=new Date(), d=new Date(ts), s=(now-d)/1000;
    if(s<60) return "baru saja";
    const m=Math.floor(s/60); if(m<60) return `${m} menit lalu`;
    const h=Math.floor(m/60); if(h<24) return `${h} jam lalu`;
    const day=Math.floor(h/24); if(day<7) return `${day} hari lalu`;
    const w=Math.floor(day/7); if(w<4) return `${w} minggu lalu`;
    const mo=Math.floor(day/30); return `${mo} bulan lalu`;
  }

  let notes=[], currentPage=1, perPage=5;
  async function loadNotes(){
    try{
      const res=await fetch(scriptURL);
      notes=await res.json();
      notes.sort((a,b)=> new Date(b.timestamp)-new Date(a.timestamp));
      renderNotes();
    }catch{
      document.getElementById("notesContainer").innerHTML="<p>‚ùå Gagal load notes.</p>";
    }
  }
  function renderNotes(){
    const box=document.getElementById('notesContainer'); box.innerHTML="";
    if(!notes.length){ box.innerHTML="<p>No notes yet.</p>"; return; }
    const start=(currentPage-1)*perPage; const page=notes.slice(start,start+perPage);
    page.forEach((n,i)=>{
      const el=document.createElement('div'); el.className='note'; el.style.transitionDelay=(i*80)+"ms";
      const icon = n.attendance==="Yes" ? "üíñ" : (n.attendance==="No" ? "üå∏" : "");
      el.innerHTML = `<strong style="color:var(--rose)">${(n.name||"Guest").toString().replace(/</g,"&lt;")}</strong> ${icon}<br>
                      <em>${(n.notes||'').toString().replace(/</g,'&lt;')}</em><br>
                      <small>${timeAgo(n.timestamp)}</small>`;
      box.appendChild(el); requestAnimationFrame(()=> el.classList.add('show'));
    });
    document.getElementById('prevBtn').disabled = start<=0;
    document.getElementById('nextBtn').disabled = start+perPage >= notes.length;
  }
  document.getElementById('prevBtn').addEventListener('click', ()=>{ if(currentPage>1){ currentPage--; renderNotes(); }});
  document.getElementById('nextBtn').addEventListener('click', ()=>{ if(currentPage*perPage<notes.length){ currentPage++; renderNotes(); }});
  loadNotes();

  /* ===== Aira chat: knowledge & logic ===== */
  const KNOWLEDGE = {
    couple: "Zen & Yessica",
    date: new Date("2026-01-17T09:00:00+07:00"),
    datingAnniversary: new Date("2019-05-28T00:00:00+07:00"),
    favorites: { groomColor: "Biru", brideColor: "Kuning" },
    dreams: { groom: "Memiliki rumah di pegunungan", couple: "Keluarga bahagia" },
    hobbies: { groom: [], bride: [], couple: [] },   // isi kalau sudah ada
    funFacts: [],                                     // isi array fun facts kalau ada
    maps: {
      matrimony: "https://www.google.com/maps/search/?api=1&query=Gereja+Santo+Fransiskus+Asisi,+Cibinong",
      reception: "https://www.google.com/maps/search/?api=1&query=Bagas+Raya+Cibinong"
    },
    calendarLink:
      "https://calendar.google.com/calendar/render?action=TEMPLATE&text=Zen+%26+Yessica+Wedding&dates=20260117T030000Z/20260117T090000Z&details=Join+us+for+our+wedding+day!&location=Gereja+Santo+Fransiskus+Asisi,+Cibinong"
  };

  const aiFab   = document.getElementById('aiFab');
  const aiPanel = document.getElementById('aiPanel');
  const aiClose = document.getElementById('aiClose');
  const aiBody  = document.getElementById('aiBody');
  const aiForm  = document.getElementById('aiForm');
  const aiText  = document.getElementById('aiText');
  const guest   = new URLSearchParams(location.search).get('to');

  function openAI(){
    aiPanel.classList.add('open'); aiText.focus();
    if (!sessionStorage.getItem('aira_welcomed')) {
      botSay(`Halo${guest ? ' ' + guest : ''}! Aku <b>Aira</b> üëã. Aku bisa bantu info acara ${KNOWLEDGE.couple}: waktu, lokasi, RSVP, arah ke tempat, dan lainnya.`);
      sessionStorage.setItem('aira_welcomed','1');
    }
  }
  function closeAI(){ aiPanel.classList.remove('open'); }
  aiFab.addEventListener('click', ()=> aiPanel.classList.contains('open') ? closeAI() : openAI());
  aiClose.addEventListener('click', closeAI);
  document.addEventListener('keydown', (e)=>{ if(e.key==='Escape') closeAI(); });

  /* Chat helpers */
  const LOG_KEY = 'aira_chat_log';
  function renderMsg(role, html){
    const wrap = document.createElement('div');
    wrap.className = 'ai-msg ' + (role === 'user' ? 'user' : 'ai');
    const b = document.createElement('div');
    b.className = 'ai-bubble'; b.innerHTML = html;
    wrap.appendChild(b); aiBody.appendChild(wrap);
    aiBody.scrollTop = aiBody.scrollHeight;
  }
  function userSay(text){ renderMsg('user', escapeHtml(text)); saveLog('user', escapeHtml(text)); }
  function botSay(html){ renderMsg('ai', html); saveLog('ai', html); }
  function escapeHtml(s){ return s.replace(/[<>&"]/g, c => ({'<':'&lt;','>':'&gt;','&':'&amp;','"':'&quot;'}[c])) }
  function saveLog(role, html){
    const arr = JSON.parse(localStorage.getItem(LOG_KEY)||'[]');
    arr.push({role, html}); localStorage.setItem(LOG_KEY, JSON.stringify(arr.slice(-50)));
  }
  (function loadLog(){
    try{
      const arr = JSON.parse(localStorage.getItem(LOG_KEY)||'[]');
      arr.forEach(m => renderMsg(m.role, m.html));
    }catch{}
  })();

  const fmtDate = (d) => d.toLocaleString('id-ID', { weekday:'long', year:'numeric', month:'long', day:'numeric', hour:'2-digit', minute:'2-digit', timeZone:'Asia/Jakarta' });
  const formatDateShort = (d) => d.toLocaleDateString('id-ID', { day:'2-digit', month:'long', year:'numeric', timeZone:'Asia/Jakarta' });
  function daysTo(d){
    const ms = d.getTime() - Date.now();
    if (ms <= 0) return "Hari ini!";
    const DD = Math.floor(ms/86400000), HH = Math.floor((ms%86400000)/3600000);
    return `${DD} hari ${HH} jam lagi`;
  }
  function pick(arr){ return arr[Math.floor(Math.random()*arr.length)]; }
  function smoothJump(id){ const el=document.querySelector(id); if(el){ el.scrollIntoView({behavior:'smooth'}); } }

  function reply(text){
    const q = text.toLowerCase();

    if (/\b(hai|halo|hello|hi)\b/.test(q)) return `Halo${guest ? ' ' + guest : ''}! Ada yang bisa Aira bantu?`;
    if (/siapa|pengantin|couple|bride|groom/.test(q)) return `Acara ini untuk <b>${KNOWLEDGE.couple}</b> ü•Ç.`;

    if (/kapan|tanggal|jam|time|when|countdown|berapa hari/.test(q))
      return `Pemberkatan dimulai <b>${fmtDate(KNOWLEDGE.date)}</b> (WIB). Tersisa <b>${daysTo(KNOWLEDGE.date)}</b>.`;

    if (/jadian|anniv|anniversary|sejak.*(bersama|pacaran)|kapan.*jadian|tanggal.*jadian/.test(q)) {
      return `Tanggal jadian: <b>${formatDateShort(KNOWLEDGE.datingAnniversary)}</b> üíû`;
    }

    if (/warna( favorit| kesukaan)?|favorite color/.test(q)) {
      const askGroom = /(zen|groom|laki|cowok)/.test(q);
      const askBride = /(yessica|bride|perempuan|cewek)/.test(q);
      if (askGroom)  return `Warna kesukaan Zen: <b>${KNOWLEDGE.favorites.groomColor}</b> üíô`;
      if (askBride)  return `Warna kesukaan Yessica: <b>${KNOWLEDGE.favorites.brideColor}</b> üíõ`;
      return `Warna favorit: Zen <b>${KNOWLEDGE.favorites.groomColor}</b> üíô & Yessica <b>${KNOWLEDGE.favorites.brideColor}</b> üíõ`;
    }

    if (/impian|cita-cita|mimpi|goals?/.test(q))
      return `Impian Zen: <b>${KNOWLEDGE.dreams.groom}</b> üèîÔ∏è<br>Impian bersama: <b>${KNOWLEDGE.dreams.couple}</b> ü´∂`;

    if (/hobi|hobby|kegemaran|interest/.test(q)) {
      const g = KNOWLEDGE.hobbies.groom?.length ? KNOWLEDGE.hobbies.groom.join(", ") : "(belum diisi)";
      const b = KNOWLEDGE.hobbies.bride?.length ? KNOWLEDGE.hobbies.bride.join(", ") : "(belum diisi)";
      const c = KNOWLEDGE.hobbies.couple?.length ? KNOWLEDGE.hobbies.couple.join(", ") : "(belum diisi)";
      return `Hobi Zen: <b>${g}</b><br>Hobi Yessica: <b>${b}</b><br>Hobi berdua: <b>${c}</b>`;
    }

    if (/fun\s*fact|fakta unik|unik/.test(q))
      return KNOWLEDGE.funFacts?.length ? pick(KNOWLEDGE.funFacts) : "Fun fact belum ditambahkan üôÇ";

    if (/di mana|lokasi|alamat|where|maps|arah|route|direction/.test(q))
      return `Lokasi: <br>‚Ä¢ Pemberkatan: <a href="${KNOWLEDGE.maps.matrimony}" target="_blank">Gereja Santo Fransiskus Asisi, Cibinong</a><br>‚Ä¢ Resepsi: <a href="${KNOWLEDGE.maps.reception}" target="_blank">Bagas Raya Cibinong</a>`;

    if (/rsvp|konfirmasi|hadir|attend|daftar/.test(q)){ setTimeout(()=> smoothJump('#rsvp'), 300); return `Kamu bisa RSVP di bagian <b>RSVP & Notes</b> pada halaman ini. Aku sudah menggulir ke sana üòâ.`; }

    if (/calendar|kalender|save the date|ingatkan/.test(q))
      return `Klik <a href="${KNOWLEDGE.calendarLink}" target="_blank">Add to Google Calendar</a> untuk menyimpan tanggalnya.`;

    if (/musik|music|lagu|sound/.test(q)) return `Tombol musik ada di kanan bawah (ikon ‚ñ∂Ô∏è/‚è∏Ô∏è).`;
    if (/dress|tema|baju|warna/.test(q)) return `Pilihan aman: <b>semi-formal</b> warna lembut/pastel.`;

    return `Aku bisa bantu hal-hal seperti:<br>
    ‚Ä¢ ‚ÄúKapan mulai?‚Äù / ‚ÄúBerapa hari lagi?‚Äù<br>
    ‚Ä¢ ‚ÄúLokasi di mana?‚Äù<br>
    ‚Ä¢ ‚ÄúKapan jadian?‚Äù / ‚ÄúAnniversary?‚Äù<br>
    ‚Ä¢ ‚ÄúWarna favorit Zen/Yessica?‚Äù<br>
    ‚Ä¢ ‚ÄúImpian / hobi / fun fact?‚Äù<br>
    ‚Ä¢ ‚ÄúCara RSVP gimana?‚Äù`;
  }

  aiForm.addEventListener('submit', (e)=>{
    e.preventDefault();
    const text = aiText.value.trim(); if(!text) return;
    userSay(text); botSay(reply(text)); aiText.value='';
  });
</script>
</body>
</html>
