<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Wedding Invitation - Zen & Yessica</title>
  <!-- Google Fonts -->
  <link href="https://fonts.googleapis.com/css2?family=Great+Vibes&family=Poppins:wght@300;400;600&display=swap" rel="stylesheet">
  <style>
    body, html {
      margin: 0;
      padding: 0;
      font-family: 'Poppins', sans-serif;
      background: #fff;
      color: #333;
      height: 100%;
      overflow-x: hidden;
    }
    h1, h2 {
      font-family: 'Great Vibes', cursive;
      color: #bc6c89;
    }

    /* Cover */
    .cover {
      position: fixed;
      top: 0; left: 0;
      width: 100%; height: 100%;
      background: linear-gradient(135deg, #fbd3e9, #91a1f0);
      display: flex;
      flex-direction: column;
      justify-content: center;
      align-items: center;
      text-align: center;
      z-index: 9999;
      transition: opacity 0.8s ease, visibility 0.8s ease;
    }
    .cover h1 {
      font-size: 3rem;
      color: white;
      margin-bottom: 10px;
      text-shadow: 1px 1px 6px rgba(0,0,0,0.3);
    }
    .cover p {
      font-size: 1.2rem;
      color: white;
      margin-bottom: 30px;
    }
    .cover button {
      padding: 12px 30px;
      border: none;
      border-radius: 30px;
      background: white;
      color: #bc6c89;
      font-size: 1rem;
      font-weight: 600;
      cursor: pointer;
      transition: background 0.3s, color 0.3s;
    }
    .cover button:hover {
      background: #bc6c89;
      color: white;
    }
    .cover.hidden {
      opacity: 0;
      visibility: hidden;
    }

    section { padding: 50px 20px; text-align: center; }
    .date { font-size: 1.3rem; margin: 15px 0; }
    .venue { margin: 8px 0; font-style: italic; }
    .verse { font-style: italic; max-width: 600px; margin: auto; line-height: 1.5; color: #555; }
    footer { background: #333; color: white; padding: 20px; margin-top: 40px; }

    /* Hero */
    .hero {
      height: 100vh;
      background: linear-gradient(135deg, #fbd3e9, #bbd2c5, #91a1f0);
      display: flex;
      flex-direction: column;
      justify-content: center;
      align-items: center;
      padding: 20px;
      color: white;
      text-shadow: 1px 1px 6px rgba(0,0,0,0.3);
    }
    .hero h1 { font-size: 4rem; margin-bottom: 15px; }
    .hero .quote { max-width: 600px; font-size: 1.2rem; margin: 20px auto 40px; line-height: 1.6; }
    #countdown {
      font-size: 1.2rem;
      font-weight: bold;
      margin: 20px 0 40px;
      display: flex;
      gap: 20px;
      justify-content: center;
    }
    .time-box span { display: block; font-size: 2rem; }
    .btn {
      display: inline-block;
      padding: 12px 30px;
      background: #bc6c89;
      border: none;
      color: white;
      border-radius: 30px;
      text-decoration: none;
      font-size: 1rem;
      transition: 0.3s;
    }
    .btn:hover { background: #a44d6c; }

    /* Music button */
    #music-control {
      position: fixed;
      bottom: 20px;
      right: 20px;
      background: #bc6c89;
      color: white;
      border: none;
      border-radius: 50%;
      width: 50px;
      height: 50px;
      font-size: 1.2rem;
      cursor: pointer;
      box-shadow: 0 4px 6px rgba(0,0,0,0.2);
      display: none;
    }

    /* RSVP Form + Notes */
    form {
      max-width: 500px;
      margin: 0 auto;
      display: flex;
      flex-direction: column;
      gap: 15px;
      text-align: left;
    }
    form input, form textarea {
      padding: 12px;
      border: 1px solid #ddd;
      border-radius: 8px;
      font-size: 1rem;
      font-family: 'Poppins', sans-serif;
    }
    form textarea { min-height: 100px; resize: vertical; }
    form button {
      background: #bc6c89;
      color: white;
      padding: 12px;
      border: none;
      border-radius: 8px;
      font-size: 1rem;
      cursor: pointer;
      transition: background 0.3s;
    }
    form button:hover { background: #a44d6c; }
    #responseMsg { text-align: center; margin-top: 15px; font-weight: 600; }

    .attendance-wrapper { margin-top: 15px; text-align: center; }
    .attendance-label { font-size: 0.9rem; color: #666; margin-bottom: 8px; }
    .attendance-options { display: flex; justify-content: center; gap: 20px; margin-bottom: 8px; }
    .attend-btn {
      padding: 12px 25px;
      font-size: 1rem;
      border: none;
      border-radius: 30px;
      cursor: pointer;
      background: #f8e1ec;
      color: #bc6c89;
      transition: 0.3s;
    }
    .attend-btn:hover { background: #bc6c89; color: white; }
    .attend-btn.active { background: #bc6c89; color: white; font-weight: 600; }

    .error-msg {
      color: #d46a6a;
      font-size: 0.9rem;
      display: none;
      margin-top: 5px;
      font-style: italic;
    }

    #notesContainer { margin-top: 30px; max-width: 600px; margin-left: auto; margin-right: auto; text-align: left; }
    .note { padding: 12px; border-bottom: 1px solid #ddd; }
    .note strong { color: #bc6c89; }
    .pagination { margin-top: 15px; display: flex; justify-content: center; gap: 10px; }
    .pagination button { padding: 8px 15px; border: none; border-radius: 6px; background: #bc6c89; color: white; cursor: pointer; }
    .pagination button:disabled { background: #ccc; cursor: not-allowed; }
  </style>
</head>
<body>

  <!-- üé∂ Music -->
  <audio id="bg-music" loop>
    <source src="music/Music-1.mp3" type="audio/mpeg">
  </audio>
  <button id="music-control">‚è∏Ô∏è</button>

  <!-- COVER PAGE -->
  <div class="cover" id="coverPage">
    <h1>Zen & Yessica</h1>
    <p>Dear <span id="guestName">Guest</span></p>
    <button id="openBtn">Open Invitation</button>
  </div>

  <!-- Save the Date -->
  <section class="hero">
    <h1>SAVE THE DATE</h1>
    <p class="quote">
      ‚ÄúMarriage is an act of worship, and every act of worship leads to His love as its ultimate goal. 
      It is only fitting that every effort to attain His love is pursued with joy.‚Äù
    </p>
    <div id="countdown">
      <div class="time-box"><span id="days">00</span>Days</div>
      <div class="time-box"><span id="hours">00</span>Hours</div>
      <div class="time-box"><span id="minutes">00</span>Minutes</div>
      <div class="time-box"><span id="seconds">00</span>Seconds</div>
    </div>
    <a class="btn" 
       href="https://calendar.google.com/calendar/render?action=TEMPLATE&text=Zen+%26+Yessica+Wedding&dates=20260117T030000Z/20260117T090000Z&details=Join+us+for+our+wedding+day!&location=Gereja+Santo+Fransiskus+Asisi,+Cibinong" 
       target="_blank">
      SAVE THE DATE
    </a>
  </section>

  <!-- Details -->
  <section>
    <h2>Wedding Day</h2>
    <p class="date">Saturday, 17 January 2026</p>
    <p class="venue">Holy Matrimony: Gereja Santo Fransiskus Asisi, Cibinong</p>
    <p class="venue">Reception: Bagas Raya Cibinong</p>
  </section>

  <!-- Verse -->
  <section>
    <h2>Bible Verse</h2>
    <p class="verse">
      ‚ÄúSo they are no longer two, but one flesh.  
      What therefore God has joined together, let no man separate.‚Äù  
      <br>‚Äì Matthew 19:6
    </p>
  </section>

  <!-- RSVP -->
  <section>
    <h2>RSVP & Notes</h2>
    <form id="rsvpForm">
      <input type="hidden" name="token" value="ZENYESSICA2026">
      <input type="hidden" id="referer" name="referer">
      <input type="hidden" id="attendanceInput" name="Attendance" required>

      <input name="Name" id="nameInput" type="text" placeholder="Name" required>
      <small id="nameError" class="error-msg">We‚Äôd love to know your name üíå</small>

      <textarea name="Notes" placeholder="Write your wishes and prayers for us"></textarea>

      <div class="attendance-wrapper">
        <p class="attendance-label">Attendance confirmation</p>
        <div class="attendance-options">
          <button type="button" class="attend-btn" data-value="Yes">üíñ Yes</button>
          <button type="button" class="attend-btn" data-value="No">üå∏ No</button>
        </div>
        <small id="attendanceError" class="error-msg">Please let us know if you can join üå∑</small>
      </div>

      <button type="submit">SEND</button>
    </form>
    <p id="responseMsg"></p>

    <h2>Guest Notes üíå</h2>
    <div id="notesContainer">Loading...</div>
    <div class="pagination">
      <button id="prevBtn">Prev</button>
      <button id="nextBtn">Next</button>
    </div>
  </section>

  <footer>
    <p>With love, Zen & Yessica üíï</p>
  </footer>

  <script>
    const scriptURL = "https://script.google.com/macros/s/AKfycbwRSHvhi28_Fes26DuLR8Ywf0zqY2U7ePzQCdb_4vyUH_Nq0_culqdSfb1U7tajj8zT/exec";
    document.getElementById("referer").value = window.location.hostname;

    // Cover Page
    const cover = document.getElementById("coverPage");
    const openBtn = document.getElementById("openBtn");
    const music = document.getElementById("bg-music");
    const controlBtn = document.getElementById("music-control");

    const urlParams = new URLSearchParams(window.location.search);
    const guest = urlParams.get("to");
    if (guest) document.getElementById("guestName").textContent = guest;

    openBtn.addEventListener("click", () => {
      cover.classList.add("hidden");
      controlBtn.style.display = "block";
      music.play().catch(err => console.log("Autoplay blocked:", err));
    });

    controlBtn.addEventListener("click", () => {
      if (music.paused) { music.play(); controlBtn.textContent = "‚è∏Ô∏è"; }
      else { music.pause(); controlBtn.textContent = "‚ñ∂Ô∏è"; }
    });

    // Countdown
    function updateCountdown() {
      const weddingDate = new Date("Jan 17, 2026 09:00:00").getTime();
      const now = new Date().getTime();
      const diff = weddingDate - now;
      if (diff <= 0) {
        document.getElementById("countdown").innerHTML = "üéâ Today is the wedding day!";
        return;
      }
      const days = Math.floor(diff / (1000*60*60*24));
      const hours = Math.floor((diff % (1000*60*60*24)) / (1000*60*60));
      const minutes = Math.floor((diff % (1000*60*60)) / (1000*60));
      const seconds = Math.floor((diff % (1000*60)) / 1000);
      document.getElementById("days").textContent = days;
      document.getElementById("hours").textContent = hours;
      document.getElementById("minutes").textContent = minutes;
      document.getElementById("seconds").textContent = seconds;
    }
    setInterval(updateCountdown, 1000);
    updateCountdown();

    // RSVP validation
    const form = document.getElementById("rsvpForm");
    const nameInput = document.getElementById("nameInput");
    const nameError = document.getElementById("nameError");
    const attendanceBtns = document.querySelectorAll(".attend-btn");
    const attendanceInput = document.getElementById("attendanceInput");
    const attendanceError = document.getElementById("attendanceError");
    const msg = document.getElementById("responseMsg");

    attendanceBtns.forEach(btn => {
      btn.addEventListener("click", () => {
        attendanceBtns.forEach(b => b.classList.remove("active"));
        btn.classList.add("active");
        attendanceInput.value = btn.getAttribute("data-value");
        attendanceError.style.display = "none";
      });
    });

    form.addEventListener("submit", e => {
      let valid = true;
      if (!nameInput.value.trim()) {
        nameError.style.display = "block";
        valid = false;
      } else {
        nameError.style.display = "none";
      }
      if (!attendanceInput.value) {
        attendanceError.style.display = "block";
        valid = false;
      } else {
        attendanceError.style.display = "none";
      }
      if (!valid) { e.preventDefault(); return; }

      e.preventDefault();
      msg.textContent = "‚è≥ Sending...";
      msg.style.color = "gray";

      fetch(scriptURL, { method: "POST", body: new FormData(form) })
        .then(res => res.json())
        .then(data => {
          if (data.status === "success") {
            msg.textContent = "‚úÖ RSVP berhasil dikirim! Thank you üíï";
            msg.style.color = "green";
            form.reset();
            attendanceBtns.forEach(b => b.classList.remove("active"));
            attendanceInput.value = "";
            loadNotes();
          } else {
            msg.textContent = "‚ùå Gagal mengirim RSVP.";
            msg.style.color = "red";
          }
        })
        .catch(err => {
          msg.textContent = "‚ùå Error: " + err;
          msg.style.color = "red";
        });
    });

    // Notes pagination
    let notes = [];
    let currentPage = 1;
    const notesPerPage = 5;

    async function loadNotes() {
      try {
        const res = await fetch(scriptURL);
        notes = await res.json();
        renderNotes();
      } catch (err) {
        document.getElementById("notesContainer").innerHTML = "<p>‚ùå Gagal load notes.</p>";
      }
    }

    function renderNotes() {
      const container = document.getElementById("notesContainer");
      container.innerHTML = "";

      if (!notes.length) {
        container.innerHTML = "<p>No notes yet.</p>";
        return;
      }

      const start = (currentPage - 1) * notesPerPage;
      const end = start + notesPerPage;
      const pageNotes = notes.slice(start, end);

      pageNotes.forEach(n => {
        container.innerHTML += `
          <div class="note">
            <strong>${n.name}</strong> (${n.attendance})<br>
            <em>${n.notes}</em><br>
            <small>${new Date(n.timestamp).toLocaleString()}</small>
          </div>
        `;
      });

      document.getElementById("prevBtn").disabled = currentPage === 1;
      document.getElementById("nextBtn").disabled = end >= notes.length;
    }

    document.getElementById("prevBtn").addEventListener("click", () => {
      if (currentPage > 1) { currentPage--; renderNotes(); }
    });
    document.getElementById("nextBtn").addEventListener("click", () => {
      if ((currentPage * notesPerPage) < notes.length) { currentPage++; renderNotes(); }
    });

    loadNotes();
  </script>
</body>
</html>
