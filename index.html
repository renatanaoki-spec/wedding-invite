<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Wedding Invitation - Zen & Yessica</title>
  <style>
    * { margin:0; padding:0; box-sizing:border-box; }
    body, html { height:100%; font-family:Arial, sans-serif; background:#333; color:white; }

    /* Desktop Layout */
    .container { display:flex; height:100vh; }
    .left { flex:0 0 65%; background:url("image/Main-Image.jpeg") no-repeat center center/cover; }
    .right { flex:0 0 35%; background:rgba(0,0,0,0.6); padding:40px 20px; text-align:center; overflow-y:auto; }
    .right h2 { margin-top:30px; }

    /* Mobile Cover */
    .mobile-cover {
      display:none; height:100vh; width:100%;
      background:url("image/cover.jpg") no-repeat center center/cover;
      color:white; text-align:center; justify-content:center; align-items:center;
    }
    .mobile-cover .overlay { background:rgba(0,0,0,0.5); padding:40px 20px; border-radius:10px; width:90%; }
    .open-btn { padding:12px 25px; border:none; border-radius:25px; background:white; color:black; font-weight:bold; cursor:pointer; }

    /* Mobile Content */
    .mobile-content { display:none; min-height:100vh; background:rgba(0,0,0,0.6); padding:20px; text-align:center; overflow-y:auto; }

    /* Music button */
    #music-control { position:fixed; bottom:20px; right:20px; background:rgba(0,0,0,0.6); color:white; border:2px solid white; border-radius:50%; width:55px; height:55px; font-size:22px; cursor:pointer; display:none; }

    /* Wishes */
    #wishesList, #wishesListMobile { text-align:left; margin-top:20px; padding:10px; background:rgba(255,255,255,0.1); border-radius:8px; max-height:300px; overflow-y:auto; }
    .wish { margin-bottom:10px; padding:10px; border-bottom:1px solid #666; }

    /* Responsive */
    @media (max-width:768px) {
      .container { display:none; }
      .mobile-cover { display:flex; }
    }
  </style>
</head>
<body>
  <!-- Background Music -->
  <audio id="bg-music" loop>
    <source src="music/Dive-Olivia Dean-Acoustic.mp3" type="audio/mpeg">
  </audio>
  <button id="music-control">üîä</button>

  <!-- Desktop view -->
  <div class="container">
    <div class="left"></div>
    <div class="right">
      <h3>Dear Mr/Mrs [Guest Name]</h3>
      <h1>Zen & Yessica</h1>
      <p>Wedding Thanksgiving Greeting</p>
      <p>Saturday, 17 January 2025</p>
      <hr>
      <p style="margin:20px 0; font-style:italic;">
        ‚ÄúSo they are no longer two, but one flesh.<br>What therefore God has joined together, let no man separate.‚Äù<br>Matthew 19:6
      </p>

      <h2>The Groom</h2><p>Zen</p>
      <h2>The Bride</h2><p>Yessica</p>
      <h2>Save the Date</h2><p>Saturday, 17 January 2025</p>

      <!-- Location Sections -->
      <h2>Holy Matrimony</h2>
      <p>Gereja Santo Fransiskus Asisi</p>
      <a href="https://maps.app.goo.gl/Mhi1TxmzQpiAWSjo9" target="_blank" style="color:#ffd;">üìç View Map</a>

      <h2>Reception</h2>
      <p>Bagas Raya Cibinong</p>
      <a href="https://maps.app.goo.gl/1EEFd33p6nrv7vUcA" target="_blank" style="color:#ffd;">üìç View Map</a>

      <h2>Our Moment</h2><img src="image/photo1.jpg" width="100%">

      <!-- RSVP Form -->
      <h2>RSVP & Wishes</h2>
      <form id="rsvpForm" method="POST" action="https://script.google.com/macros/s/AKfycbwspA-PN2szYXXJCDgqJeP5Tqd3b1FULfpnRKzijFcHUA0iOpsHVfjV94eVzh7LR92Z/exec">
        <input name="Name" type="text" placeholder="Your Name" required style="width:90%; padding:10px; margin:5px 0;"><br>
        <select name="Attendance" required style="width:90%; padding:10px; margin:5px 0;">
          <option value="">-- Apakah Anda akan hadir? --</option>
          <option value="Ya">Ya, saya akan hadir</option>
          <option value="Tidak">Maaf, saya tidak bisa hadir</option>
        </select><br>
        <textarea name="Wishes" placeholder="Your wishes..." style="width:90%; padding:10px; margin:5px 0;"></textarea><br>
        <button type="submit" style="padding:10px 20px; background:#bc8887; color:white; border:none; border-radius:8px;">Send</button>
      </form>
      <p id="responseMsg"></p>

      <!-- All Wishes -->
      <h2 style="margin-top:40px;">All Wishes üíå</h2>
      <div id="wishesList"><p>Loading wishes...</p></div>
      <div style="margin-top:10px; text-align:center;">
        <button id="prevBtn">‚¨Ö Prev</button>
        <span id="pageInfo"></span>
        <button id="nextBtn">Next ‚û°</button>
      </div>
    </div>
  </div>

  <!-- Mobile Cover -->
  <div class="mobile-cover" id="mobileCover">
    <div class="overlay">
      <p>WEDDING THANKSGIVING GREETINGS</p>
      <h1>ZEN <span>&</span> YESSICA</h1>
      <p>SATURDAY, JANUARY 17<sup>th</sup> 2025</p>
      <p>Without diminishing respect,<br>We invite you to attend our wedding ceremony.</p>
      <button class="open-btn" onclick="openInvitation()">OPEN INVITATION</button>
    </div>
  </div>

  <!-- Mobile Content -->
  <div class="mobile-content" id="mobileContent">
    <h3>Dear Mr/Mrs [Guest Name]</h3>
    <h1>Zen & Yessica</h1>
    <p>Saturday, 17 January 2025</p>
    <hr>
    <p style="margin:20px 0; font-style:italic;">
      ‚ÄúSo they are no longer two, but one flesh.<br>What therefore God has joined together, let no man separate.‚Äù<br>Matthew 19:6
    </p>

    <h2>The Groom</h2><p>Zen</p>
    <h2>The Bride</h2><p>Yessica</p>
    <h2>Save the Date</h2><p>Saturday, 17 January 2025</p>

    <!-- Location Sections -->
    <h2>Holy Matrimony</h2>
    <p>Gereja Santo Fransiskus Asisi</p>
    <a href="https://maps.app.goo.gl/Mhi1TxmzQpiAWSjo9" target="_blank" style="color:#ffd;">üìç View Map</a>

    <h2>Reception</h2>
    <p>Bagas Raya Cibinong</p>
    <a href="https://maps.app.goo.gl/1EEFd33p6nrv7vUcA" target="_blank" style="color:#ffd;">üìç View Map</a>

    <h2>Our Moment</h2><img src="image/Main-image.jpeg" width="100%">

    <!-- RSVP Form -->
    <h2>RSVP & Wishes</h2>
    <form id="rsvpFormMobile" method="POST" action="https://script.google.com/macros/s/AKfycbwspA-PN2szYXXJCDgqJeP5Tqd3b1FULfpnRKzijFcHUA0iOpsHVfjV94eVzh7LR92Z/exec">
      <input name="Name" type="text" placeholder="Your Name" required style="width:90%; padding:10px; margin:5px 0;"><br>
      <select name="Attendance" required style="width:90%; padding:10px; margin:5px 0;">
        <option value="">-- Apakah Anda akan hadir? --</option>
        <option value="Ya">Ya, saya akan hadir</option>
        <option value="Tidak">Maaf, saya tidak bisa hadir</option>
      </select><br>
      <textarea name="Wishes" placeholder="Your wishes..." style="width:90%; padding:10px; margin:5px 0;"></textarea><br>
      <button type="submit" style="padding:10px 20px; background:#bc8887; color:white; border:none; border-radius:8px;">Send</button>
    </form>
    <p id="responseMsgMobile"></p>

    <!-- All Wishes -->
    <h2 style="margin-top:40px;">All Wishes üíå</h2>
    <div id="wishesListMobile"><p>Loading wishes...</p></div>
    <div style="margin-top:10px; text-align:center;">
      <button id="prevBtnMobile">‚¨Ö Prev</button>
      <span id="pageInfoMobile"></span>
      <button id="nextBtnMobile">Next ‚û°</button>
    </div>
  </div>

  <script>
    // === MUSIC CONTROL ===
    const music = document.getElementById("bg-music");
    const controlBtn = document.getElementById("music-control");
    function openInvitation() {
      document.getElementById("mobileCover").style.display = "none";
      document.getElementById("mobileContent").style.display = "block";
      music.play().catch(()=>{});
      controlBtn.style.display = "block";
    }
    controlBtn.addEventListener("click", () => {
      if (music.paused) { music.play(); controlBtn.textContent = "üîä"; }
      else { music.pause(); controlBtn.textContent = "üîá"; }
    });
    document.addEventListener("visibilitychange", () => {
      if (document.hidden) { music.pause(); controlBtn.textContent = "üîá"; }
      else { music.play().catch(()=>{}); controlBtn.textContent = "üîä"; }
    });

    // === RSVP + WISHES ===
    const scriptURL = "https://script.google.com/macros/s/AKfycbwspA-PN2szYXXJCDgqJeP5Tqd3b1FULfpnRKzijFcHUA0iOpsHVfjV94eVzh7LR92Z/exec";

    function setupForm(formId, msgId) {
      const form = document.getElementById(formId);
      const msg = document.getElementById(msgId);
      if (!form) return;
      if (!form.dataset.bound) {
        form.dataset.bound = true;
        form.addEventListener("submit", e => {
          e.preventDefault();
          const submitBtn = form.querySelector("button[type='submit']");
          submitBtn.disabled = true;
          fetch(scriptURL, { method:"POST", body:new FormData(form)})
            .then(res=>res.json())
            .then(()=>{
              msg.textContent="‚úÖ RSVP berhasil dikirim!";
              msg.style.color="lightgreen";
              form.reset();
              loadWishes();
            })
            .catch(()=>{
              msg.textContent="‚ùå Gagal mengirim RSVP.";
              msg.style.color="red";
            })
            .finally(()=>{ submitBtn.disabled = false; });
        });
      }
    }

    setupForm("rsvpForm","responseMsg");
    setupForm("rsvpFormMobile","responseMsgMobile");

    // === WISHES LIST ===
    let page = 1;
    const perPage = 10;

    function timeAgo(dateString) {
      const now = new Date();
      const date = new Date(dateString);
      const diff = (now - date) / 1000;
      if (diff < 60) return "baru saja";
      const minutes = Math.floor(diff/60);
      if (minutes < 60) return `${minutes} menit lalu`;
      const hours = Math.floor(minutes/60);
      if (hours < 24) return `${hours} jam lalu`;
      const days = Math.floor(hours/24);
      if (days < 7) return `${days} hari lalu`;
      const weeks = Math.floor(days/7);
      return `${weeks} minggu lalu`;
    }

    async function loadWishes() {
      try {
        const res = await fetch(scriptURL);
        const data = await res.json();
        renderWishes(data,"wishesList","pageInfo","prevBtn","nextBtn");
        renderWishes(data,"wishesListMobile","pageInfoMobile","prevBtnMobile","nextBtnMobile");
      } catch {
        document.getElementById("wishesList").innerHTML="<p>‚ùå Gagal load ucapan.</p>";
      }
    }

    function renderWishes(data,listId,pageId,prevId,nextId){
      const list=document.getElementById(listId);
      const pageInfo=document.getElementById(pageId);
      const prev=document.getElementById(prevId);
      const next=document.getElementById(nextId);
      const start=(page-1)*perPage;
      const end=start+perPage;
      const pageData=data.slice(start,end);

      list.innerHTML=pageData.map(w=>`
        <div class="wish">
          <strong>${w.name}</strong><br>
          <em>"${w.wishes}"</em><br>
          <small>${timeAgo(w.timestamp)}</small>
        </div>`).join("");

      pageInfo.textContent=`Page ${page} of ${Math.ceil(data.length/perPage)}`;
      prev.disabled=page===1;
      next.disabled=end>=data.length;
      prev.onclick=()=>{if(page>1){page--;loadWishes();}};
      next.onclick=()=>{if(end<data.length){page++;loadWishes();}};
    }

    loadWishes();
  </script>
</body>
</html>
