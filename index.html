<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Wedding Invitation - Zen & Yessica</title>
  <style>
    * { margin:0; padding:0; box-sizing:border-box; }
    body, html { height:100%; font-family:Arial, sans-serif; }

    /* Desktop Layout */
    .container { display:flex; height:100vh; }
    .left {
      flex:0 0 65%;
      background:url("image/image (2).jpeg") no-repeat center center/cover;
    }
    .right {
      flex:0 0 35%;
      background:rgba(0,0,0,0.6);
      color:white;
      padding:40px 20px;
      text-align:center;
      overflow-y:auto;
    }
    .right h2 { margin-top:30px; }

    /* Mobile Cover */
    .mobile-cover {
      display:none; height:100vh; width:100%;
      background:url("image/images (2).jpeg") no-repeat center center/cover;
      background-size:cover; color:white; text-align:center;
      justify-content:center; align-items:center;
    }
    .mobile-cover .overlay {
      background:rgba(0,0,0,0.5);
      padding:40px 20px; border-radius:10px; width:90%;
    }
    .subtitle { font-size:14px; letter-spacing:2px; margin-bottom:10px; }
    .couple { font-size:28px; font-weight:bold; margin:5px 0; }
    .couple span { font-family:"Times New Roman", serif; font-size:30px; font-weight:normal; }
    .date { font-size:14px; margin-bottom:20px; }
    .invite-text { font-size:14px; line-height:1.5; margin-bottom:25px; }
    .open-btn {
      padding:12px 25px; font-size:16px; border:none;
      border-radius:25px; background:white; color:black;
      font-weight:bold; cursor:pointer;
    }

    /* Mobile Content */
    .mobile-content {
      display:none; min-height:100vh;
      background:rgba(0,0,0,0.6); color:white;
      padding:20px; overflow-y:auto; text-align:center;
    }

    /* Music button */
    #music-control {
      position:fixed; bottom:20px; right:20px;
      background:rgba(0,0,0,0.6); color:white;
      border:2px solid white; border-radius:50%;
      width:55px; height:55px; font-size:22px;
      cursor:pointer; display:none;
    }

    /* Responsive */
    @media(max-width:768px){
      .container{display:none;} 
      .mobile-cover{display:flex;}
    }
  </style>
</head>
<body>
  <!-- Background Music -->
  <audio id="bg-music" loop>
    <source src="music/Dive-Olivia Dean-Acoustic.mp3" type="audio/mpeg">
  </audio>
  <button id="music-control">üîä</button>

  <!-- Desktop view -->
  <div class="container">
    <div class="left"></div>
    <div class="right">
      <h3 style="margin-bottom:20px;">Dear Mr/Mrs [Guest Name]</h3>
      <h1>Zen & Yessica</h1>
      <p>Wedding Thanksgiving Greeting</p>
      <p>Saturday, 17 January 2025</p>
      <hr style="width:80%; margin:20px auto; border:0.5px solid #fff;">
      <p style="margin:20px 0; font-style:italic;">
        ‚ÄúSo they are no longer two, but one flesh.<br>
        What therefore God has joined together, let no man separate.‚Äù<br>
        Matthew 19:6
      </p>

      <!-- RSVP Form -->
      <h2>RSVP & Wishes</h2>
      <form id="rsvpForm">
        <input name="Name" type="text" placeholder="Your Name" required style="width:90%; padding:10px; margin:5px 0;"><br>
        <select name="Attendance" required style="width:90%; padding:10px; margin:5px 0;">
          <option value="">-- Apakah Anda akan hadir? --</option>
          <option value="Ya">Ya, saya akan hadir</option>
          <option value="Tidak">Maaf, saya tidak bisa hadir</option>
        </select><br>
        <textarea name="Wishes" placeholder="Your wishes..." style="width:90%; padding:10px; margin:5px 0;"></textarea><br>
        <button type="submit" style="padding:10px 20px; background:#bc8887; color:white; border:none; border-radius:8px;">Send</button>
      </form>
      <p id="responseMsg" style="margin-top:10px; font-size:14px;"></p>

      <!-- Wishes Section -->
      <h2 style="margin-top:40px;">All Wishes üíå</h2>
      <div id="wishesList" style="text-align:left; margin-top:20px; padding:10px; background:rgba(255,255,255,0.1); border-radius:8px; max-height:300px; overflow-y:auto;">
        <p>Loading wishes...</p>
      </div>
      <div style="margin-top:10px; text-align:center;">
        <button id="prevBtn" style="padding:5px 10px; margin:5px;">‚¨Ö Prev</button>
        <span id="pageInfo"></span>
        <button id="nextBtn" style="padding:5px 10px; margin:5px;">Next ‚û°</button>
      </div>
    </div>
  </div>

  <!-- Mobile Cover -->
  <div class="mobile-cover" id="mobileCover">
    <div class="overlay">
      <p class="subtitle">WEDDING THANKSGIVING GREETINGS</p>
      <h1 class="couple">ZEN <span>&</span> YESSICA</h1>
      <p class="date">SATURDAY, JANUARY 17<sup>th</sup> 2025</p>
      <p class="invite-text">Without diminishing respect,<br>We invite you to attend our wedding ceremony.</p>
      <button class="open-btn" onclick="openInvitation()">OPEN INVITATION</button>
    </div>
  </div>

  <!-- Mobile Content -->
  <div class="mobile-content" id="mobileContent">
    <h3 style="margin-bottom:20px;">Dear Mr/Mrs [Guest Name]</h3>
    <h1>Zen & Yessica</h1>
    <p>Saturday, 17 January 2025</p>
    <hr style="width:80%; margin:20px auto; border:0.5px solid #fff;">
    <p style="margin:20px 0; font-style:italic;">
      ‚ÄúSo they are no longer two, but one flesh.<br>
      What therefore God has joined together, let no man separate.‚Äù<br>
      Matthew 19:6
    </p>
  </div>

  <script>
    // === Music control ===
    const music = document.getElementById("bg-music");
    const controlBtn = document.getElementById("music-control");
    function openInvitation() {
      document.getElementById("mobileCover").style.display = "none";
      document.getElementById("mobileContent").style.display = "block";
      music.play().catch(()=>{});
      controlBtn.style.display = "block";
    }
    controlBtn.addEventListener("click", () => {
      if (music.paused) { music.play(); controlBtn.textContent = "üîä"; }
      else { music.pause(); controlBtn.textContent = "üîá"; }
    });
    document.addEventListener("visibilitychange", () => {
      if (document.hidden) { music.pause(); controlBtn.textContent = "üîá"; }
      else { music.play().catch(()=>{}); controlBtn.textContent = "üîä"; }
    });

    // === RSVP + Wishes ===
    const scriptURL = "https://script.google.com/macros/s/AKfycbxnThVrO_I1-hVn2r6J4TWUGGtRiCA_oQLeaHzwzNk9SjRW59ZQglxLaJwDrrkvP64o/exec";
    const rsvpForm = document.getElementById("rsvpForm");
    const responseMsg = document.getElementById("responseMsg");
    rsvpForm.addEventListener("submit", e => {
      e.preventDefault();
      fetch(scriptURL, { method: "POST", body: new FormData(rsvpForm)})
        .then(() => {
          responseMsg.textContent = "‚úÖ RSVP berhasil dikirim!";
          responseMsg.style.color = "lightgreen";
          rsvpForm.reset();
          loadWishes();
        })
        .catch(error => {
          responseMsg.textContent = "‚ùå Gagal mengirim RSVP.";
          responseMsg.style.color = "red";
          console.error(error);
        });
    });

    // === Wishes Pagination ===
    const wishesList = document.getElementById("wishesList");
    const prevBtn = document.getElementById("prevBtn");
    const nextBtn = document.getElementById("nextBtn");
    const pageInfo = document.getElementById("pageInfo");
    let wishesData = [], currentPage = 1, perPage = 10;

    async function loadWishes() {
      try {
        const res = await fetch(scriptURL);
        wishesData = await res.json();
        wishesData.sort((a,b)=> new Date(b.timestamp)-new Date(a.timestamp));
        renderPage(1);
      } catch(err) {
        wishesList.innerHTML="<p>‚ùå Gagal memuat wishes.</p>";
        console.error(err);
      }
    }

    function renderPage(page) {
      currentPage = page;
      const start=(page-1)*perPage, end=start+perPage;
      const items=wishesData.slice(start,end);
      wishesList.innerHTML=items.map(item=>`
        <div style="margin-bottom:15px; padding:10px; border-bottom:1px solid rgba(255,255,255,0.2);">
          <p><strong>${item.name}</strong> (${item.attendance})</p>
          <p style="margin:5px 0; font-style:italic;">"${item.wishes||''}"</p>
          <small style="opacity:0.7;">${new Date(item.timestamp).toLocaleString()}</small>
        </div>
      `).join("");
      const totalPages=Math.ceil(wishesData.length/perPage);
      pageInfo.textContent=`Page ${page} of ${totalPages}`;
      prevBtn.disabled=(page===1);
      nextBtn.disabled=(page===totalPages);
    }
    prevBtn.addEventListener("click",()=>{ if(currentPage>1) renderPage(currentPage-1); });
    nextBtn.addEventListener("click",()=>{ const totalPages=Math.ceil(wishesData.length/perPage); if(currentPage<totalPages) renderPage(currentPage+1); });
    loadWishes();
  </script>
</body>
</html>
